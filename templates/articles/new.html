<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script src="https://cdn.jsdelivr.net/highlight.js/latest/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/latest/styles/github.min.css">

<div>
    <form>
        <div class="form-group">
            <label for="exampleInputEmail1">Title</label>
            <input type="title" class="form-control" id="postTile" name="postTitle" aria-describedby="postTitle" placeholder="Enter title">
        </div>
        <div class="form-group">
            <label for="postContent">Content</label>
            <textarea id="postContent" name="postContent" class="form-control"></textarea>
        </div>
        <button type="button" id="btnPostNow" class="btn btn-primary">Post Now</button>
    </form>    
</div>

<script>
    var simplemde = new SimpleMDE({ 
            element: $("#postContent")[0],
            placeholder: "Enter content here...",
            renderingConfig: {
                singleLineBreaks: false,
                codeSyntaxHighlighting: true,
            },
        });
    //simplemde.value("default value");
    $( "#btnPostNow" ).click(function() {
        htmlValue = simplemde.markdown(simplemde.value())
        postData = {
            Title: $("#postTile").val(),
            Content: htmlValue,
            Markdown: simplemde.value(),
        }
        $.ajax({
            type: "POST",
            url: "/api/v1/articles",
            data: JSON.stringify(postData),
            contentType: "application/json; charset=utf-8",
            crossDomain: true,
            dataType: "json",
            success: function (data, status, jqXHR) {
                $(location).attr('href', '/articles/details/'+data.ID)
            },
            error: function (jqXHR, status) {
                console.log(jqXHR);
                alert('fail' + status.code);
            }
        });
    });

    
</script>