{{ range .}}
<div class="row vertical-align-top catalogue-item-wrapper">
    <div class="col-sm-1">
        <div id=article-{{.ID}} class="upvote" onclick="upVote(this, {{.ID}})">
            <a class="upvote" >
                <span class="glyphicon glyphicon-arrow-up"></span>
            </a>
            <span id="article-vote-count-{{.ID}}" class="count">{{.VoteCount}}</span>
        </div>
    </div>
    <div class="col-sm-11">
        <a href="/articles/{{.ID}}/details" class="catalogue-item">
            <div>
                <div>
                    <span class="catalogue-title">{{.Title}}</span>
                    <span class="catalogue-time">{{shortDate .LastUpdate}}</span>
                </div>
                <div class="catalogue-content">
                    {{htmlNoEscape .Content }}
                </div>
            </div>
        </a>
    </div>
</div>
{{ else }}
<h1>No post found</h1>
{{ end }}

<link rel="stylesheet" href="../static/js/upvote/upvote.css">

<script>
    function upVote(el, id) {
        var userID = getCookie("_user_id");
        if (userID != "") {
            $.ajax({
                type: "POST",
                url: "/api/v1/articles/"+id+"/vote",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                success: function (data, status, jqXHR) {
                    el.querySelector("#article-vote-count-" +id).innerHTML=data.count;
                },
                error: function (jqXHR, status) {
                    alert('Oooops: fail to vote. Please login first!');
                }
            });
        } else {
            $(location).attr('href', getCookie("_login_url"))
        }
    }
</script>

<style>
    .catalogue-item-wrapper {
        box-shadow: 0px 0px 5px rgb(51, 51, 51);
        box-shadow: 0px 0px 5px rgba(51, 51, 51, 0.7);
        padding: 10px 10px 10px 10px;
        margin: 0px 0px 20px;
        background-color: white;
    }

    @media (max-width: 600px){
        .catalogue-item-wrapper {
            margin: 5px auto 0px auto;
        }
    }

    .catalogue-item{
        border-bottom:1px solid #e5e5e5;
        color:#555;
        display:inline-block;
    }
    .catalogue-content {
        text-overflow: ellipsis;
        word-wrap: break-word;
        overflow: hidden;
        max-height: 20em;
    }
    .catalogue-item:hover {
        text-decoration: none;
        color:#555;
    }

    .catalogue-item:hover .catalogue-line,.catalogue-item:focus .catalogue-line{
        width:5rem
    }
    .catalogue-item:last-child{
        border:0
    }
    .catalogue-time{
        color:#aaa;
        font-family:"Helvetica Neue","Segoe UI",Helvetica,Arial,sans-serif;
        letter-spacing:.5px;
        font-weight: bold;
        font-size: 0.8rem;
        margin-left: 10px;
    }
    .catalogue-title{
        color:#353535;
        font-family:"Helvetica Neue","Segoe UI",Helvetica,Arial,sans-serif;
        font-size:1.2rem;
        font-weight:700;
        margin:0.5rem 0 0.5rem 0;
    }
    .catalogue-line{
        -webkit-transition:all 0.3s ease-out;
        -moz-transition:all 0.3s ease-out;
        transition:all 0.3s ease-out;
        border-top:0.2rem solid #353535;
        display:block;
        width:0.5rem
    }

    div.upvote {
    text-align: center;
    }

    div.upvote a {
        background-repeat: no-repeat;
        overflow: hidden;
        display: block;
        width: 41px;
        height: 25px;
        font-size: 1.5rem;
        cursor: pointer;
    }

    div.upvote span.count {
        display: block;
        font-size: 18px;
        font-weight: bold;
        font-family: Arial, Liberation, Sans, DejaVu Sans, sans-serif;
        color: #555;
        margin: 0.15rem 0
    }

    div.upvote a.upvote {
        margin: auto;
    }

    div.upvote a.downvote {
        margin: auto;
    }
</style>